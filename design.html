<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body{
            margin:0px;
        }
        #wrapper{
            width:1500px;
            height:900px;
            background: brown;
            margin:auto;
            box-sizing: border-box;
            position: relative;
        }
        #side{
            width:400px;
            height:100%;
            background:wheat;
            position:relative;
            float: left;
        }

        #lifeBox, #scoreBox, #timeBox{
            width:80%;
            height:100px;
            background:yellowgreen;
            margin-top: 50px;
            margin-left: 10%;

        }

        #mapBox{
            width:80%;
            height:300px;
            background:skyblue;
            margin-top: 50px;
            margin-left: 10%;
        }
        #playBox{
            width:1100px;
            height:100%;
            background:#CCC;
            position: relative;
            float: left;
        }
        #heroInfo{
            width:600px;
            height:100px;
            background:burlywood;
            margin-left:20%;
            font-size: 50px;
        }


    </style>
    <script src="./lib.js"></script>
    <script src="./GameObject.js"></script>
    <script src="./map.js"></script>
    <script src="./Brick.js"></script>
    <script src="./Hero.js"></script>
    <script src="./Enemy.js"></script>
    <script src="./Item.js"></script>
    <script src="./Sensor.js"></script>
    <script src="./LeftSensor.js"></script>
    <script src="./RightSensor.js"></script>
    <script src="./TopSensor.js"></script>
    <script src="./BottomSensor.js"></script>
    <script>
        let lifeBox;
        let scoreBox;
        let timeBox;
        let mapBox;
        let playBox;




        let mapArray=[map1,map2];
        let level=0;

        let brickArray=[];
        let hero;

        let heroInfo;
        function createBrick(){
            for(let a=0;a<18;a++){
                for(let i=0;i<22;i++){
                    if(mapArray[level][a][i]==1){

                        let brick = new Brick(playBox,"./images/brick.png",50,50,50*i,50*a,0,0);
                        brickArray.push(brick);
                    }else if(mapArray[level][a][i]==2){
                        hero = new Hero(playBox,"./mineworker.png",50,50,50*i,50*a,0,0);
                    }else if(mapArray[level][a][i]==3){
                        let enemy= new Enemy(playBox,"./images/enemy.png",50,50,50*i,50*a,0,0);                    
                    }else if(mapArray[level][a][i]==4){
                        let speed= new Item(playBox,"./images/speed.png",50,50,50*i,50*a,0,0);                    
                    }else if(mapArray[level][a][i]==5){
                        let life= new Item(playBox,"./images/life.png",50,50,50*i,50*a,0,0);                    
                    }else if(mapArray[level][a][i]==6){
                        let clock= new Item(playBox,"./images/clock.png",50,50,50*i,50*a,0,0);                    
                    }   
                }

            }
        }
        //주인공 x 축 이동
        function heroX(n){
            for(let i=0;i<brickArray.length;i++){
                

                hero.velX=n;
                
            }
        }
        //주인공 y 축 이동
        function heroY(n){
            hero.velY=n;
        }
       
        function loop(){
            
            hero.tick();
            hero.render();
            heroInfo.innerText="heroX: "+hero.x+"   hero.Y: "+ hero.y;

        }
        function init(){
            lifeBox = document.getElementById("lifeBox");
            scoreBox = document.getElementById("scoreBox");
            timeBox = document.getElementById("timeBox");
            mapBox = document.getElementById("mapBox");
            playBox = document.getElementById("playBox");
            heroInfo = document.getElementById("heroInfo");
            createBrick();
            
        }
        addEventListener("load",function(){
            init();
            setInterval("loop()",10);
            //주인공을 키보드로 제어
            addEventListener("keydown",function(e){
                if(e.keyCode==37){
                    heroX(-5);

                    



                }else if(e.keyCode==38){
                    heroY(-5);

                    for(let i=0;i<brickArray.length;i++){
                        let result = collisionCheck(hero,brickArray[i]);
                        if(result){
                            hero.x=brickArray[i].x+brickArray[i].width;
                            //this.y=brickArray[i].y-this.height;
                            //this.x=checkX;
                            //this.y=checkY;
                        } 
                    }

                }else if(e.keyCode==39){
                    heroX(5);



                }else if(e.keyCode==40){
                    heroY(5);
                }
                // switch(e.keyCode){
                //     case 37: heroX(-5);break; //좌
                //     case 38: heroY(-5);break; //위
                //     case 39: heroX(5);break; //우
                //     case 40: heroY(5);break; //아래
                // }
            });      
            addEventListener("keyup",function(e){
                switch(e.keyCode){
                    case 37: heroX(0);break; //좌
                    case 38: heroY(0);break; //위
                    case 39: heroX(0);break; //우
                    case 40: heroY(0);break; //아래
                }
            });       
        });
        </script>
</head>
<body>
    <div id="wrapper">
        <div id="side">
            <div id="lifeBox">
                
            </div>
            <div id="scoreBox">

            </div>
            <div id="timeBox">

            </div>
            <div id="mapBox">

            </div>
        </div>
        <div id="playBox"></div>

    </div>
    <div id="heroInfo"></div>
    
</body>
</html>